<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}}</title>
    <link rel="stylesheet" href="/static/css/header.css">
    <link rel="stylesheet" href="/static/css/admin.css">
</head>
<body>
    <div class="page-container">
        <!-- –®–∞–ø–∫–∞ -->
        <header class="header">
             <div class="header-container">
                <div class="header-inner">
                    <a href="/admin" class="logo">
                        <img src="/static/images/logo.jpg" alt="GainWave" class="logo-img">
                        <span>GainWave</span>
                    </a>
                    <nav class="nav">  
                        <div class="header-actions">
                            <!-- –ö–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ CSV -->
                            <a href="/admin/export-csv" class="header-btn backup-btn" title="–≠–∫—Å–ø–æ—Ä—Ç –ë–î –≤ CSV">
                                üì• –≠–∫—Å–ø–æ—Ä—Ç CSV
                            </a>
                            
                            <!-- –§–æ—Ä–º–∞ –∏–º–ø–æ—Ä—Ç–∞ CSV -->
                            <form action="/admin/import-csv" method="POST" enctype="multipart/form-data" class="import-form">
                                <input type="file" name="csv_file" accept=".csv" id="csvFile" style="display: none;" onchange="this.form.submit()">
                                <button type="button" class="header-btn import-btn" onclick="document.getElementById('csvFile').click()" title="–ò–º–ø–æ—Ä—Ç –ë–î –∏–∑ CSV">
                                    üì§ –ò–º–ø–æ—Ä—Ç CSV
                                </button>
                            </form>
                             
                        <a href="/admin/report" class="report-header-btn" target="_blank">
                            üìä –°–∫–∞—á–∞—Ç—å –æ—Ç—á–µ—Ç Excel
                        </a>                     
                        <form action="/logout" method="POST" class="logout-form"> 
                            <button type="submit" class="logout-btn">–í—ã–π—Ç–∏</button>
                        </form>
                    </nav>
                </div>
            </div>
        </header>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="main">
            <div class="container">
                <div class="admin-page">
                    <h1 class="page-title">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
                    
                    <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
                    {{if .Message}}
                    <div class="admin-message {{if .Success}}success{{else}}error{{end}}">
                        {{.Message}}
                    </div>
                    {{end}}

                    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º -->
                    <div class="admin-tabs">
                        <a href="/admin?section=products" class="tab-btn {{if eq .CurrentSection "products"}}active{{end}}">–¢–æ–≤–∞—Ä—ã</a>
                        <a href="/admin?section=ban" class="tab-btn {{if eq .CurrentSection "ban"}}active{{end}}">–ë–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</a>
                        
                    </div>

                    <!-- –†–∞–∑–¥–µ–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞–º–∏ -->
                    {{if eq .CurrentSection "products"}}
                    <div class="admin-section">
                        <div class="section-header">
                            <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h2>
                            <a href="/admin?section=products&action=add" class="btn btn-primary">+ –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</a>
                        </div>

                        <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ -->
                        {{if or (eq .Action "add") (eq .Action "edit")}}
                        <div class="admin-form-section">
                            <h3>{{if eq .Action "add"}}–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞{{else}}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞{{end}}</h3>
                            <form method="POST" action="/admin/products/save" class="admin-form">
                                <input type="hidden" name="product_id" value="{{.Product.ProductID}}">
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="name">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ *</label>
                                        <input type="text" id="name" name="name" value="{{.Product.Name}}" required>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                                        <textarea id="description" name="description" rows="3">{{.Product.Description}}</textarea>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="price">–¶–µ–Ω–∞ (BYN) *</label>
                                        <input type="number" id="price" name="price" step="0.01" value="{{.Product.Price}}" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="stock_quantity">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ *</label>
                                        <input type="number" id="stock_quantity" name="stock_quantity" value="{{.Product.StockQuantity}}" required>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="category_id">–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                                        <select id="category_id" name="category_id" required>
                                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                                            {{range .Categories}}
                                            <option value="{{.ID}}" {{if eq .ID $.Product.CategoryID}}selected{{end}}>{{.Name}}</option>
                                            {{end}}
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="producer_id">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å *</label>
                                        <select id="producer_id" name="producer_id" required>
                                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è</option>
                                            {{range .Producers}}
                                            <option value="{{.ID}}" {{if eq .ID $.Product.ProducerID}}selected{{end}}>{{.Name}}</option>
                                            {{end}}
                                        </select>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="image_url">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                                        <input type="text" id="image_url" name="image_url" value="{{.Product.ImageURL}}">
                                    </div>
                                </div>

                                <div class="form-actions">
                                    <a href="/admin?section=products" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</a>
                                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                                </div>
                            </form>
                        </div>
                        {{end}}

                        <!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ -->
                        {{if not .Action}}
                        <div class="admin-table-section">
                            <div class="table-container">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</th>
                                            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                            <th>–¶–µ–Ω–∞</th>
                                            <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                                            <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                            <th>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å</th>
                                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {{range .Products}}
                                        <tr>
                                            <td>{{.ProductID}}</td>
                                            <td>
                                                {{if .ImageURL}}
                                                <img src="/static/images/{{.CategoryName}}/{{.ImageURL}}" alt="{{.Name}}" class="product-thumb">
                                                {{else}}
                                                <span class="no-image">–ù–µ—Ç —Ñ–æ—Ç–æ</span>
                                                {{end}}
                                            </td>
                                            <td>{{.Name}}</td>
                                            <td>{{.Price}} BYN</td>
                                            <td>{{.StockQuantity}}</td>
                                            <td>{{.CategoryName}}</td>
                                            <td>{{.ProducerName}}</td>
                                            <td class="actions">
                                                <a href="/admin?section=products&action=edit&id={{.ProductID}}" class="btn-edit">‚úèÔ∏è</a>
                                                <form action="/admin/products/delete" method="POST" class="inline-form">
                                                    <input type="hidden" name="product_id" value="{{.ProductID}}">
                                                    <button type="submit" class="btn-delete" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä?')">üóëÔ∏è</button>
                                                </form>
                                            </td>
                                        </tr>
                                        {{else}}
                                        <tr>
                                            <td colspan="8" class="no-data">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</td>
                                        </tr>
                                        {{end}}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        {{end}}
                    </div>
                    {{end}}

                    <!-- –†–∞–∑–¥–µ–ª –±–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
                    {{if eq .CurrentSection "ban"}}
                    <div class="admin-section">
                        <div class="section-header">
                            <h2>–ë–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2>
                        </div>

                        <div class="admin-form-section">
                            <h3>–ë–∞–Ω –ø–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                            <form method="POST" action="/admin/users/ban" class="admin-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="user_id">ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è *</label>
                                        <input type="number" id="user_id" name="user_id" required placeholder="–í–≤–µ–¥–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                                    </div>
                                </div>
                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary">–ó–∞–±–∞–Ω–∏—Ç—å</button>
                                </div>
                            </form>
                        </div>

                        <div class="admin-form-section">
                            <h3>–†–∞–∑–±–∞–Ω –ø–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                            <form method="POST" action="/admin/users/unban" class="admin-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="user_id">ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è *</label>
                                        <input type="number" id="user_id" name="user_id" required placeholder="–í–≤–µ–¥–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                                    </div>
                                </div>
                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary">–†–∞–∑–±–∞–Ω–∏—Ç—å</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    {{end}}
                </div>
            </div>
        </main>
    </div>
</body>
</html>